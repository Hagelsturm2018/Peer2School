{"remainingRequest":"/Users/jannikschilling/Documents/Hagelsturm2018.github.io/peer2school-master/node_modules/babel-loader/lib/index.js!/Users/jannikschilling/Documents/Hagelsturm2018.github.io/peer2school-master/node_modules/eslint-loader/index.js??ref--13-0!/Users/jannikschilling/Documents/Hagelsturm2018.github.io/peer2school-master/src/state.js","dependencies":[{"path":"/Users/jannikschilling/Documents/Hagelsturm2018.github.io/peer2school-master/src/state.js","mtime":1584780410000},{"path":"/Users/jannikschilling/Documents/Hagelsturm2018.github.io/peer2school-master/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jannikschilling/Documents/Hagelsturm2018.github.io/peer2school-master/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/jannikschilling/Documents/Hagelsturm2018.github.io/peer2school-master/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLmVuZHMtd2l0aCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi50aW1lcnMiOwppbXBvcnQgeyBnZXRVc2VyTWVkaWEgfSBmcm9tICcuL2xpYi91c2VybWVkaWEnOwppbXBvcnQgeyBVVUlELCBVVUlEX2xlbmd0aCB9IGZyb20gJy4vbGliL3V1aWQnOwppbXBvcnQgeyBXZWJSVEMgfSBmcm9tICcuL2xpYi93ZWJydGMnOyAvLyBGb3JjZSBhIHVuaXF1ZSByb29tIElECgp2YXIgdGVhY2hlclRva2VuID0gJy50ZWFjaGVyJzsKdmFyIGhhc2ggPSAobG9jYXRpb24uaGFzaCB8fCAiIyIuY29uY2F0KFVVSUQoKSkuY29uY2F0KHRlYWNoZXJUb2tlbikpLnN1YnN0cigxKTsKdmFyIHRlYWNoZXIgPSBoYXNoLmVuZHNXaXRoKHRlYWNoZXJUb2tlbik7CnZhciByb29tID0gaGFzaC5zdWJzdHIoMCwgVVVJRF9sZW5ndGgpOwpsb2NhdGlvbi5oYXNoID0gIiMiLmNvbmNhdChoYXNoKTsKZXhwb3J0IHZhciBzdGF0ZSA9IHsKICByb29tOiByb29tLAogIHRlYWNoZXI6IHRlYWNoZXIsCiAgcGVlcnM6IFtdLAogIHN0YXR1czoge30sCiAgY2hhdDogW10sCiAgc3RyZWFtOiBudWxsCn07CmdldFVzZXJNZWRpYShmdW5jdGlvbiAoc3RyZWFtKSB7CiAgc3RhdGUuc3RyZWFtID0gc3RyZWFtOwp9KTsKZXhwb3J0IHZhciB3ZWJydGMgPSBuZXcgV2ViUlRDKHsKICByb29tOiByb29tCn0pOwp3ZWJydGMub24oJ3N0YXR1cycsIGZ1bmN0aW9uIChpbmZvKSB7CiAgc3RhdGUuc3RhdHVzID0gaW5mby5zdGF0dXM7Cn0pOwp3ZWJydGMub24oJ2NoYXQnLCBmdW5jdGlvbiAobXNnKSB7CiAgc3RhdGUuY2hhdC5wdXNoKG1zZyk7Cn0pOwp3ZWJydGMub24oJ2Nvbm5lY3RlZCcsIGZ1bmN0aW9uIChfcmVmKSB7CiAgdmFyIHBlZXIgPSBfcmVmLnBlZXI7CiAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICBwZWVyLmFkZFN0cmVhbShzdGF0ZS5zdHJlYW0pOwogIH0sIDEwMDApOwp9KTsKZXhwb3J0IGZ1bmN0aW9uIHNlbmRDaGF0TWVzc2FnZShtc2cpIHsKICB3ZWJydGMuc2VuZCgnY2hhdCcsIHsKICAgIHNlbmRlcjogd2VicnRjLmlvLmlkLAogICAgbXNnOiBtc2cKICB9KTsKICBzdGF0ZS5jaGF0LnB1c2goewogICAgc2VuZGVyOiAnbWUnLAogICAgbXNnOiBtc2cKICB9KTsKfQpleHBvcnQgZnVuY3Rpb24gZ2V0UGVlcihpZCkgewogIHJldHVybiB3ZWJydGMucGVlckNvbm5lY3Rpb25zW2lkXTsKfQ=="},{"version":3,"sources":["/Users/jannikschilling/Documents/Hagelsturm2018.github.io/peer2school-master/src/state.js"],"names":["getUserMedia","UUID","UUID_length","WebRTC","teacherToken","hash","location","substr","teacher","endsWith","room","state","peers","status","chat","stream","webrtc","on","info","msg","push","peer","setTimeout","addStream","sendChatMessage","send","sender","io","id","getPeer","peerConnections"],"mappings":";;;AAAA,SAASA,YAAT,QAA6B,iBAA7B;AACA,SAASC,IAAT,EAAeC,WAAf,QAAkC,YAAlC;AACA,SAASC,MAAT,QAAuB,cAAvB,C,CAEA;;AACA,IAAMC,YAAY,GAAG,UAArB;AACA,IAAIC,IAAI,GAAG,CAACC,QAAQ,CAACD,IAAT,eAAqBJ,IAAI,EAAzB,SAA8BG,YAA9B,CAAD,EAA+CG,MAA/C,CAAsD,CAAtD,CAAX;AACA,IAAIC,OAAO,GAAGH,IAAI,CAACI,QAAL,CAAcL,YAAd,CAAd;AACA,IAAIM,IAAI,GAAGL,IAAI,CAACE,MAAL,CAAY,CAAZ,EAAeL,WAAf,CAAX;AACAI,QAAQ,CAACD,IAAT,cAAoBA,IAApB;AAEA,OAAO,IAAIM,KAAK,GAAG;AACjBD,EAAAA,IAAI,EAAJA,IADiB;AAEjBF,EAAAA,OAAO,EAAPA,OAFiB;AAGjBI,EAAAA,KAAK,EAAE,EAHU;AAIjBC,EAAAA,MAAM,EAAE,EAJS;AAKjBC,EAAAA,IAAI,EAAE,EALW;AAMjBC,EAAAA,MAAM,EAAE;AANS,CAAZ;AASPf,YAAY,CAAC,UAAAe,MAAM,EAAI;AACrBJ,EAAAA,KAAK,CAACI,MAAN,GAAeA,MAAf;AACD,CAFW,CAAZ;AAIA,OAAO,IAAIC,MAAM,GAAG,IAAIb,MAAJ,CAAW;AAAEO,EAAAA,IAAI,EAAJA;AAAF,CAAX,CAAb;AAEPM,MAAM,CAACC,EAAP,CAAU,QAAV,EAAoB,UAAAC,IAAI,EAAI;AAC1BP,EAAAA,KAAK,CAACE,MAAN,GAAeK,IAAI,CAACL,MAApB;AACD,CAFD;AAIAG,MAAM,CAACC,EAAP,CAAU,MAAV,EAAkB,UAAAE,GAAG,EAAI;AACvBR,EAAAA,KAAK,CAACG,IAAN,CAAWM,IAAX,CAAgBD,GAAhB;AACD,CAFD;AAIAH,MAAM,CAACC,EAAP,CAAU,WAAV,EAAuB,gBAAc;AAAA,MAAXI,IAAW,QAAXA,IAAW;AACnCC,EAAAA,UAAU,CAAC,YAAM;AACfD,IAAAA,IAAI,CAACE,SAAL,CAAeZ,KAAK,CAACI,MAArB;AACD,GAFS,EAEP,IAFO,CAAV;AAGD,CAJD;AAMA,OAAO,SAASS,eAAT,CAAyBL,GAAzB,EAA8B;AACnCH,EAAAA,MAAM,CAACS,IAAP,CAAY,MAAZ,EAAoB;AAClBC,IAAAA,MAAM,EAAEV,MAAM,CAACW,EAAP,CAAUC,EADA;AAElBT,IAAAA,GAAG,EAAHA;AAFkB,GAApB;AAIAR,EAAAA,KAAK,CAACG,IAAN,CAAWM,IAAX,CAAgB;AACdM,IAAAA,MAAM,EAAE,IADM;AAEdP,IAAAA,GAAG,EAAHA;AAFc,GAAhB;AAID;AAED,OAAO,SAASU,OAAT,CAAiBD,EAAjB,EAAqB;AAC1B,SAAOZ,MAAM,CAACc,eAAP,CAAuBF,EAAvB,CAAP;AACD","sourcesContent":["import { getUserMedia } from './lib/usermedia'\nimport { UUID, UUID_length } from './lib/uuid'\nimport { WebRTC } from './lib/webrtc'\n\n// Force a unique room ID\nconst teacherToken = '.teacher'\nlet hash = (location.hash || `#${UUID()}${teacherToken}`).substr(1)\nlet teacher = hash.endsWith(teacherToken)\nlet room = hash.substr(0, UUID_length)\nlocation.hash = `#${hash}`\n\nexport let state = {\n  room,\n  teacher,\n  peers: [],\n  status: {},\n  chat: [],\n  stream: null,\n}\n\ngetUserMedia(stream => {\n  state.stream = stream\n})\n\nexport let webrtc = new WebRTC({ room })\n\nwebrtc.on('status', info => {\n  state.status = info.status\n})\n\nwebrtc.on('chat', msg => {\n  state.chat.push(msg)\n})\n\nwebrtc.on('connected', ({ peer }) => {\n  setTimeout(() => {\n    peer.addStream(state.stream)\n  }, 1000)\n})\n\nexport function sendChatMessage(msg) {\n  webrtc.send('chat', {\n    sender: webrtc.io.id,\n    msg,\n  })\n  state.chat.push({\n    sender: 'me',\n    msg,\n  })\n}\n\nexport function getPeer(id) {\n  return webrtc.peerConnections[id]\n}\n"]}]}